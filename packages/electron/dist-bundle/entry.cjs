(()=>{"use strict";var e={24:e=>{e.exports=require("node:fs")},136:e=>{e.exports=require("node:url")},288:e=>{e.exports=require("electron")},317:function(e,t,r){var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),a=0;a<r.length;a++)"default"!==r[a]&&i(t,e,r[a]);return o(t,e),t}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setupSecurityHandlers=w,t.getBrowserWindowOptions=v,t.createWindow=function(){const e=new c(v());if(w(e.webContents),g){const t=process.env.VITE_DEV_SERVER_URL??"http://localhost:5173";p.default.info("Loading dev URL:",t),e.loadURL(t)}else{const t=d.resolve(y,"../../renderer/dist/index.html");p.default.info("Loading production file:",t),e.loadFile(t)}return e};const l=s(r(288)),{BrowserWindow:c,shell:u}=l.default,d=a(r(760)),f=r(136),p=s(r(446)),h=r(758),g=!1;function w(e){e.setWindowOpenHandler(({url:e})=>((0,h.isUrlAllowed)(e)?u.openExternal(e):p.default.warn("Blocked window.open to URL:",e),{action:"deny"})),e.on("will-navigate",(e,t)=>{t.startsWith("file://")||t.startsWith("http://localhost:5173")||(e.preventDefault(),(0,h.isUrlAllowed)(t)?u.openExternal(t):p.default.warn("Blocked navigation to URL:",t))})}const y="undefined"!=typeof __dirname?__dirname:d.dirname((0,f.fileURLToPath)("file:///Users/moskibitskiy/pets/task-master-editor/packages/electron/src/main.ts"));function v(){return{width:1024,height:768,show:!0,webPreferences:{contextIsolation:!0,sandbox:!0,nodeIntegration:!1,preload:d.join(y,"preload.cjs")}}}},401:(e,t,r)=>{r.r(t),r.d(t,{Channels:()=>n,validateFileReadInput:()=>a,validateFileReadResult:()=>s,validateFileWriteInput:()=>l,validateFileWriteResult:()=>c,validateSettingsData:()=>u,validateSettingsGetResult:()=>d,validateSettingsUpdateInput:()=>f,validateSettingsUpdateResult:()=>p,validateWorkspaceSelectOptions:()=>i,validateWorkspaceSelectResult:()=>o});const n={workspaceSelect:"workspace:select",fileRead:"file:read",fileWrite:"file:write",settingsGet:"settings:get",settingsUpdate:"settings:update"};function i(e){const t=e??{},r=t.type??"directory";if("directory"!==r&&"file"!==r)throw new Error('type must be "directory" or "file"');const n=t.multiple??!1;if("boolean"!=typeof n)throw new Error("multiple must be boolean");return{type:r,multiple:n}}function o(e){const t=e??{},r=Array.isArray(t.paths)?t.paths:[];if(!r.every(e=>"string"==typeof e))throw new Error("paths must be string[]");return{paths:r}}function a(e){const t=e??{},r=t.path;if("string"!=typeof r||r.length<1)throw new Error("path must be non-empty string");const n=t.encoding??"utf-8";if("utf-8"!==n)throw new Error('encoding must be "utf-8"');return{path:r,encoding:n}}function s(e){const t=e??{};if("string"!=typeof t.data)throw new Error("data must be string");return{data:t.data}}function l(e){const t=e??{},r=t.path,n=t.data;if("string"!=typeof r||r.length<1)throw new Error("path must be non-empty string");if("string"!=typeof n)throw new Error("data must be string");const i=t.encoding??"utf-8";if("utf-8"!==i)throw new Error('encoding must be "utf-8"');return{path:r,data:n,encoding:i}}function c(e){if(!0!==(e??{}).ok)throw new Error("ok must be true");return{ok:!0}}function u(e){const t=e??{},r=Array.isArray(t.recentPaths)?t.recentPaths:[];if(!r.every(e=>"string"==typeof e))throw new Error("recentPaths must be string[]");return{recentPaths:r,preferences:t.preferences??void 0}}function d(e){return{settings:u((e??{}).settings)}}function f(e){const t=e??{},r={};if("recentPaths"in t&&(r.recentPaths=u({recentPaths:t.recentPaths}).recentPaths),"preferences"in t){const e=t.preferences;if(null!=e&&"object"!=typeof e)throw new Error("preferences must be object");r.preferences=e}return{settings:r}}function p(e){return d(e)}},429:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.registerIpcHandlers=function(){o.handle(u.Channels.workspaceSelect,async(e,t)=>{try{const e=(0,u.validateWorkspaceSelectOptions)(t??{}),r=[];"directory"===e.type&&r.push("openDirectory"),"file"===e.type&&r.push("openFile"),e.multiple&&r.push("multiSelections");const n=await a.showOpenDialog({properties:r}),i={paths:n.canceled?[]:n.filePaths};return(0,u.validateWorkspaceSelectResult)(i)}catch(e){const t=e instanceof Error?e.message:String(e);throw c.default.error("workspace:select error",e),new Error(`workspace:select validation/error: ${t}`)}}),o.handle(u.Channels.fileRead,async(e,t)=>{try{const e=(0,u.validateFileReadInput)(t),r=await l.promises.readFile(e.path,{encoding:e.encoding});return(0,u.validateFileReadResult)({data:r})}catch(e){const t=e instanceof Error?e.message:String(e);throw c.default.error("file:read error",e),new Error(`file:read validation/error: ${t}`)}}),o.handle(u.Channels.fileWrite,async(e,t)=>{try{const e=(0,u.validateFileWriteInput)(t);return await l.promises.writeFile(e.path,e.data,{encoding:e.encoding}),(0,u.validateFileWriteResult)({ok:!0})}catch(e){const t=e instanceof Error?e.message:String(e);throw c.default.error("file:write error",e),new Error(`file:write validation/error: ${t}`)}}),o.handle(u.Channels.settingsGet,async()=>{const e=await p();return(0,u.validateSettingsGetResult)({settings:e})}),o.handle(u.Channels.settingsUpdate,async(e,t)=>{const r=(0,u.validateSettingsUpdateInput)(t),n=await p(),i={recentPaths:r.settings.recentPaths??n.recentPaths,preferences:r.settings.preferences??n.preferences??{}};return await async function(e){const t=await f(),r=JSON.stringify(e,null,2);await l.promises.mkdir(t.substring(0,t.lastIndexOf("/")),{recursive:!0}),await l.promises.writeFile(t,r,"utf-8"),d=e}(i),(0,u.validateSettingsUpdateResult)({settings:i})})};const i=n(r(288)),{ipcMain:o,dialog:a,app:s}=i.default,l=r(24),c=n(r(446)),u=r(401);let d=null;async function f(){return`${s.getPath("userData")}/settings.json`}async function p(){if(d)return d;try{const e=await f(),t=await l.promises.readFile(e,"utf-8");d=(0,u.validateSettingsData)(JSON.parse(t))}catch{d={recentPaths:[],preferences:{}}}return d}},446:e=>{e.exports=require("electron-log/main.js")},678:function(e,t,r){var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),a=0;a<r.length;a++)"default"!==r[a]&&i(t,e,r[a]);return o(t,e),t}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=a(r(288)),{app:c,BrowserWindow:u}=l,d=s(r(446)),f=r(317),p=r(429);d.default.initialize(),d.default.info("Task Master Editor starting"),(0,p.registerIpcHandlers)(),c.on("ready",()=>{(0,f.createWindow)(),"1"===process.env.APP_AUTO_QUIT&&setTimeout(()=>{c.quit()},1e3)}),c.on("window-all-closed",()=>{"darwin"!==process.platform&&c.quit()}),c.on("activate",()=>{0===u.getAllWindows().length&&(0,f.createWindow)()}),process.on("uncaughtException",e=>{d.default.error("Uncaught exception",e)}),process.on("unhandledRejection",e=>{d.default.error("Unhandled rejection",e)})},758:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ALLOWED_EXTERNAL_ORIGINS=void 0,t.isUrlAllowed=function(e){try{const{origin:r}=new URL(e);return t.ALLOWED_EXTERNAL_ORIGINS.has(r)}catch{return!1}},t.ALLOWED_EXTERNAL_ORIGINS=new Set(["https://github.com","https://openai.com"])},760:e=>{e.exports=require("node:path")}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n=r(678);module.exports=n})();
//# sourceMappingURL=entry.cjs.map